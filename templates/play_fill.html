<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>เกมเติมคำ - {{ game.title }}</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/play_fill.css') }}">
</head>

<body>
  <div class="container">
    <h1>{{ game.title }}</h1>
    <p>{{ game.description }}</p>

    {% if hint_words %}
      <div class="word-bank">
        <b>คำที่ใช้เติม:</b>
        {% for w in hint_words %}
          <span class="chip">{{ w }}</span>
        {% endfor %}
      </div>
    {% endif %}

    <!-- ✅ แก้ endpoint ให้ถูกต้อง -->
    <form method="POST" action="{{ url_for('game.play_game', game_id=game.id) }}" autocomplete="off">
      {% for it in items %}
        <div class="dialogue-box">
          {% set idx = namespace(value=0) %}
          {% for line in it.sentence.split('\n') %}
            <p>
              {{ line | replace('{{blank}}',
                  '<input type="text" name="q' ~ it.id ~ '_' ~ idx.value ~ '" class="blank">') | safe }}
              {% set idx.value = idx.value + line.count("{{blank}}") %}
            </p>
          {% endfor %}
        </div>
      {% endfor %}
      <button type="submit">✅ ส่งคำตอบ</button>
    </form>
  </div>
</body>
</html>
